<!--
  iespeed.html
  boost JS performance for IE11 if IESpeed ActiveX Control is installed
  (c) 2019 ITH icoserve technologies for healthcare

  v 0.8
  $Date: 2019-09-12 10:08:41 +0200 (Don, 12. Sep 2019) $
  $Revision: 91567 $
  $HeadURL: $
-->

<html>
<head>

<script language="JavaScript" type="text/javascript">

// open an URL in the IESpeed ActiveX control
function OpenURL(url) {
    document.IESpeed.Open(url);
}

// function called when browser back button is pressed
function goback() {
        window.onpopstate = null;  // temporarily disable event to avoid self trigger
        history.go(1);  // revert back button action
        window.onpopstate = function() { goback(); };  // reenable
        document.IESpeed.navigateBack();  // tell IESpeed ActiveX control to go back instead
}

function getUrl() {
    // return the URL which is stated as query string
    url = window.location.search.substr(1); // query string without leading "?"
    if (url == "") url = "about:blank"; // default page if no params given
    return url;
}

function initIESpeedControl() {
    document.IESpeed.height = "100%";
    // add a red "ferrari" border to the IESpeed ActiveX control
    document.IESpeed.style.borderColor = "red";
    document.IESpeed.border="1";
    showLoadingMessage();
    OpenURL(getUrl());
}

function OnLoad() {
    // redirect to URL if IESpeed control is not available
    if (typeof(document.IESpeed) == "undefined" || typeof(document.IESpeed.hWnd) == "undefined" || typeof(document.IESpeed.hWnd) == "unknown") {
        window.location.replace(getUrl());
    } else {
       document.IESpeed.InitIESpeed();
       // ignore browser back button and send "back" command to IESpeed instead
       if (typeof history.pushState === "function") { // only if IE JS version supports pushState
          history.pushState(null, null, location.href);
          window.onpopstate = function() { goback(); };
       }
    }
}

// display Loading message while IESpeed is loading the page
function showLoadingMessage() {
    document.IESpeed.HTML = '<div style="color:#ec6602;font-family:calibri;text-align:center;"><br><br>Loading......</div>';
}

</script>

<!-- load page after IESpeed has been initialized -->
<script language="JavaScript" for="IESpeed" event="OnBrowserReady()" type="text/javascript">
    initIESpeedControl();
</script>

</head>

<body onload="OnLoad()" style="overflow:hidden;margin:0;padding:0;box-sizing:border-box;">

<!-- load IESpeed control (must be installed, IE security settings must allow usage!) -->
<object ID="IESpeed" CLASSID="clsid:74627B42-6755-47CB-8402-AB0914774680" width="100%" height="5" border="0">
</object>

<div style="color:#ec6602;font-family:calibri;text-align:center;"><br><br>Loading...</div>

</body>
</html>
